{% extends 'base.html' %}

{% block title %}Partida | Futsal de Domingo{% endblock %}

{% block content %}
<div class="container">
    <!-- Cabeçalho da partida -->
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h1>Partida #<span id="match-number"></span></h1>
        <div>
            <button id="end-match-button" class="btn btn-danger">
                <i class="fas fa-stop-circle"></i> Encerrar Partida
            </button>
        </div>
    </div>
    
    <!-- Cronômetro -->
    <div class="match-timer-container">
        <div class="match-timer" id="match-timer">00:00</div>
        <div class="timer-controls">
            <button id="start-timer-button" class="btn btn-success">
                <i class="fas fa-play"></i> Iniciar
            </button>
            <button id="pause-timer-button" class="btn btn-warning" disabled>
                <i class="fas fa-pause"></i> Pausar
            </button>
            <button id="reset-timer-button" class="btn btn-secondary" disabled>
                <i class="fas fa-redo"></i> Zerar
            </button>
        </div>
    </div>
    
    <!-- Placar -->
    <div class="score-board">
        <div class="team-score orange">
            <button id="orange-goal-button" class="btn btn-lg btn-orange mb-2">
                <i class="fas fa-futbol"></i> Gol
            </button>
            <div class="team-name mb-1">Time Laranja</div>
            <div id="orange-score" class="team-score-value">0</div>
        </div>
        <div class="score-divider">x</div>
        <div class="team-score black">
            <button id="black-goal-button" class="btn btn-lg btn-black mb-2">
                <i class="fas fa-futbol"></i> Gol
            </button>
            <div class="team-name mb-1">Time Preto</div>
            <div id="black-score" class="team-score-value">0</div>
        </div>
    </div>
    
    <!-- Times da Partida -->
    <div class="row mb-4">
        <!-- Time Laranja -->
        <div class="col-12 col-md-6 mb-3">
            <div class="team-board team-orange">
                <div class="team-title team-orange">Time Laranja</div>
                <div id="orange-team-list">
                    <!-- Lista de jogadores será preenchida via JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Time Preto -->
        <div class="col-12 col-md-6 mb-3">
            <div class="team-board team-black">
                <div class="team-title team-black">Time Preto</div>
                <div id="black-team-list">
                    <!-- Lista de jogadores será preenchida via JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Histórico de Gols -->
    <div class="card">
        <div class="card-header">
            <h5 class="card-title">Gols da Partida</h5>
        </div>
        <div class="card-body">
            <div id="goals-container">
                <!-- Lista de gols será preenchida via JavaScript -->
            </div>
            <div id="no-goals" class="text-center py-3">
                <p class="text-muted">Nenhum gol marcado.</p>
            </div>
        </div>
    </div>
</div>

<!-- Modal Marcar Gol -->
<div id="goal-modal" class="modal-overlay">
    <div class="modal">
        <div class="modal-header">
            <h5 class="modal-title">Marcar Gol - <span id="goal-team-name"></span></h5>
            <button id="close-goal-modal" class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <form id="goal-form">
                <input type="hidden" id="goal-team" name="team">
                
                <div class="form-group mb-3">
                    <label for="goal-scorer" class="form-label">Quem marcou o gol?</label>
                    <select id="goal-scorer" name="scorer_id" class="form-control" required>
                        <option value="">-- Selecione o Jogador --</option>
                        <!-- Opções serão carregadas via JavaScript -->
                    </select>
                </div>
                
                <div class="form-group mb-3">
                    <label for="goal-assistant" class="form-label">Quem deu a assistência? (opcional)</label>
                    <select id="goal-assistant" name="assistant_id" class="form-control">
                        <option value="">-- Sem Assistência --</option>
                        <!-- Opções serão carregadas via JavaScript -->
                    </select>
                </div>
                
                <div class="modal-footer">
                    <button type="button" id="cancel-goal" class="btn btn-secondary">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Confirmar Gol</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal Confirmação Remover Gol -->
<div id="delete-goal-modal" class="modal-overlay">
    <div class="modal">
        <div class="modal-header">
            <h5 class="modal-title">Remover Gol</h5>
            <button id="close-delete-goal-modal" class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
            <p>Tem certeza que deseja remover este gol?</p>
            <p id="delete-goal-info"></p>
            
            <div class="modal-footer">
                <button type="button" id="cancel-delete-goal" class="btn btn-secondary">Cancelar</button>
                <button type="button" id="confirm-delete-goal" class="btn btn-danger">Remover</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal Tempo Esgotado -->
<div id="time-up-modal" class="modal-overlay">
    <div class="modal">
        <div class="modal-header">
            <h5 class="modal-title">Tempo Esgotado!</h5>
        </div>
        <div class="modal-body">
            <p class="text-center">O tempo regulamentar acabou!</p>
            <p class="text-center">Aguarde a bola sair de campo para encerrar a partida.</p>
            
            <div class="modal-footer">
                <button type="button" id="close-time-up-modal" class="btn btn-primary">OK</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/match.js') }}"></script>
{% endblock %}
